{% extends "layout.html" %}

{% block title %}
    Voting Page
{% endblock %}

{% block header %}
    <h1>Voting Room</h1>
    <p>Vote on your favorite restaurant</p>
    <p>Location: {{ room.Location }}</p>
{% endblock %}

{% block content %}
<section class="voting-room">
    <!-- Guest User List -->
    <div id="guest-user-list">
        <h3>Active Voters in the Room</h3>
        <ul id="guest-list" class="user-row">
            <!-- Guest user entries dynamically added here -->
        </ul>
        <!-- Placeholder for current user's avatar -->
        <div id="current-user" class="user-avatar">
            {{ current_guest_user.Username }}
        </div>
    </div>
    
    <!-- Placeholder for completion message -->
    <div id="completion-message" class="hidden">
        <p>Voting complete! Please wait for the host to finalize the results.</p>
    </div>

    <!-- Central restaurant information card -->
    <div class="restaurant-info">
        <div class="restaurant-card" id="restaurant-info">
            <!-- Restaurant Name -->
            <h3 id="restaurant-name"></h3>
            <!-- Restaurant Image -->
            <img id="restaurant-image" src="" alt="Restaurant image" style="max-width: 100%; height: auto; border-radius: 8px;">
            <!-- Rating and Review Count -->
            <p id="restaurant-rating"></p>
            <!-- Price Range -->
            <p id="restaurant-price"></p>
            <!-- Restaurant Details -->
            <p id="restaurant-description"></p>
        </div>

        <!-- Voting Buttons -->
        <div class="vote-buttons">
            <button class="vote-btn ew" id="ew-btn">Ew</button>
            <button class="vote-btn meh" id="meh-btn">Meh</button>
            <button class="vote-btn yum" id="yum-btn">Yum</button>
            {% if current_user.id == room.HostUserID %}
            <button id="end-voting-btn" style="display: none;">End Voting</button>
        {% endif %}
        </div>
        <!-- Host-only button -->
        
    </section>
</div>
    </section>
{% endblock %}

{% block scripts %}
<script>
    const roomId = "{{ room.RoomID }}";
    const userId = {{ current_user.id | default(-1) }};
    const currentGuestUser = {{ current_guest_user | tojson }};
    const hostUserId = {{ room.HostUserID }};
    const restaurantData = {{ restaurant_data | tojson }};
</script>
<script src="{{ url_for('static', filename='js/room_script.js') }}" defer></script>
{% endblock %}